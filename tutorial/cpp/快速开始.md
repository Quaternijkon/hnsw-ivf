# ğŸš€ å¿«é€Ÿå¼€å§‹æŒ‡å—

## âœ… é—®é¢˜å·²è§£å†³

ç¨‹åºå´©æºƒé—®é¢˜å·²å®Œå…¨ä¿®å¤ï¼è¯¦ç»†åˆ†æè§ [`é—®é¢˜åˆ†ææŠ¥å‘Š.md`](./é—®é¢˜åˆ†ææŠ¥å‘Š.md)

## ğŸ“ å¦‚ä½•è¿è¡Œæµ‹è¯•

### ğŸ¯ é€‰é¡¹1: å®Œæ•´å¯¹æ¯”æµ‹è¯•ï¼ˆç£ç›˜ vs å†…å­˜ç£ç›˜ï¼‰

**æ¨èï¼šéœ€è¦å®Œæ•´æ€§èƒ½å¯¹æ¯”æ—¶ä½¿ç”¨**

åœ¨æ‚¨çš„ç»ˆç«¯ä¸­æ‰‹åŠ¨è¿è¡Œï¼ˆéœ€è¦è¾“å…¥ sudo å¯†ç ï¼‰ï¼š

```bash
cd /home/gpu/dry/faiss/tutorial/cpp
./simple_disk_memory_test.sh
```

**ç‰¹ç‚¹ï¼š**
- âœ… å¯¹æ¯”æ™®é€šç£ç›˜å’Œå†…å­˜ç£ç›˜æ€§èƒ½
- âœ… åˆ†æç£ç›˜I/Oç“¶é¢ˆ
- âœ… ç”Ÿæˆè¯¦ç»†å¯¹æ¯”æŠ¥å‘Š
- âš ï¸ éœ€è¦ sudo æƒé™
- âš ï¸ éœ€è¦ 6GB+ å¯ç”¨å†…å­˜

**ç”Ÿæˆæ–‡ä»¶ï¼š**
- `disk_results.csv` - æ™®é€šç£ç›˜æ€§èƒ½æ•°æ®
- `memory_results.csv` - å†…å­˜ç£ç›˜æ€§èƒ½æ•°æ®
- `performance_comparison.md` - å¯¹æ¯”åˆ†ææŠ¥å‘Š
- `disk_test.log` / `memory_test.log` - è¯¦ç»†æ—¥å¿—

---

### âš¡ é€‰é¡¹2: å¿«é€Ÿç£ç›˜æµ‹è¯•ï¼ˆæ— éœ€sudoï¼‰

**æ¨èï¼šå¿«é€ŸéªŒè¯æˆ–æ²¡æœ‰sudoæƒé™æ—¶ä½¿ç”¨**

```bash
cd /home/gpu/dry/faiss/tutorial/cpp
./run_disk_test_only.sh
```

**ç‰¹ç‚¹ï¼š**
- âœ… æ— éœ€ sudo æƒé™
- âœ… å¿«é€Ÿè¿è¡Œ
- âœ… ç›´æ¥æµ‹è¯•å½“å‰ç£ç›˜æ€§èƒ½
- âŒ ä¸åŒ…å«å†…å­˜ç£ç›˜å¯¹æ¯”

**ç”Ÿæˆæ–‡ä»¶ï¼š**
- `benchmark_results.txt` - æ€§èƒ½æ•°æ®ï¼ˆCSVæ ¼å¼ï¼‰
- `disk_performance_test.log` - è¯¦ç»†æ—¥å¿—

---

### ğŸ”§ é€‰é¡¹3: ç›´æ¥è¿è¡ŒåŸºå‡†æµ‹è¯•

**æœ€ç®€å•ï¼šä»…è¿è¡Œæ ¸å¿ƒç¨‹åº**

```bash
cd /home/gpu/dry/faiss/tutorial/cpp
./benchmark-thread
```

è¿è¡Œåä¼šåœ¨å±å¹•ä¸Šç›´æ¥æ˜¾ç¤ºç»“æœï¼Œå¹¶ç”Ÿæˆ `benchmark_results.txt`

---

## ğŸ“‹ è¿è¡Œå‰å‡†å¤‡

### 1. æ£€æŸ¥æ•°æ®å’Œç³»ç»Ÿèµ„æº

```bash
cd /home/gpu/dry/faiss/tutorial/cpp
./check_data_size.sh
```

### 2. æ¸…ç†æ—§æµ‹è¯•ç¯å¢ƒï¼ˆå¯é€‰ï¼‰

```bash
./cleanup_and_rerun.sh
```

---

## ğŸ¯ æ¨èæµç¨‹

### é¦–æ¬¡è¿è¡Œï¼š

```bash
# 1. è¿›å…¥ç›®å½•
cd /home/gpu/dry/faiss/tutorial/cpp

# 2. æ£€æŸ¥ç¯å¢ƒ
./check_data_size.sh

# 3. é€‰æ‹©æµ‹è¯•æ–¹å¼ï¼ˆä¸‰é€‰ä¸€ï¼‰ï¼š

# æ–¹å¼A: å®Œæ•´å¯¹æ¯”æµ‹è¯•ï¼ˆæ¨èï¼‰
./simple_disk_memory_test.sh

# æ–¹å¼B: å¿«é€Ÿç£ç›˜æµ‹è¯•
./run_disk_test_only.sh

# æ–¹å¼C: ç›´æ¥è¿è¡Œ
./benchmark-thread
```

### åç»­è¿è¡Œï¼š

```bash
# æ¸…ç†åé‡æ–°è¿è¡Œ
./cleanup_and_rerun.sh
# ç„¶ååœ¨æç¤ºæ—¶é€‰æ‹© 'y' ç›´æ¥è¿è¡Œ
```

---

## ğŸ“Š æµ‹è¯•é…ç½®

å½“å‰é…ç½®ï¼ˆåœ¨ `benchmark-thread.cpp` ä¸­ï¼‰ï¼š

```cpp
// ç¬¬520è¡Œï¼šæµ‹è¯•çš„çº¿ç¨‹æ•°
std::vector<int> thread_counts = {1,5,10,15,20};

// ç¬¬522è¡Œï¼šæ¯ä¸ªé…ç½®çš„è¿è¡Œæ¬¡æ•°
const int num_runs_per_thread_setting = 1;
```

**ä¿®æ”¹å»ºè®®ï¼š**

- **å¿«é€ŸéªŒè¯**: `{1,5,10}` + `1æ¬¡è¿è¡Œ` ï¼ˆ3-5åˆ†é’Ÿï¼‰
- **æ ‡å‡†æµ‹è¯•**: `{1,5,10,15,20}` + `1æ¬¡è¿è¡Œ` ï¼ˆ5-10åˆ†é’Ÿï¼‰
- **è¯¦ç»†æµ‹è¯•**: `{1,5,10,15,20,25,30,40}` + `3æ¬¡è¿è¡Œ` ï¼ˆ20-30åˆ†é’Ÿï¼‰
- **å®Œæ•´æ‰«æ**: `{1,2,3,...,100}` + `3æ¬¡è¿è¡Œ` ï¼ˆ1-2å°æ—¶ï¼‰

---

## ğŸ“ˆ é¢„æœŸæµ‹è¯•æ—¶é—´

| æµ‹è¯•ç±»å‹ | é¦–æ¬¡è¿è¡Œ | åç»­è¿è¡Œ | è¯´æ˜ |
|---------|---------|---------|------|
| å®Œæ•´å¯¹æ¯”æµ‹è¯• | 15-25åˆ†é’Ÿ | 8-15åˆ†é’Ÿ | éœ€è¦æ„å»ºç´¢å¼•ï¼ˆé¦–æ¬¡ï¼‰ |
| å¿«é€Ÿç£ç›˜æµ‹è¯• | 10-15åˆ†é’Ÿ | 5-10åˆ†é’Ÿ | åŒ…å«ç´¢å¼•æ„å»º |
| ç›´æ¥è¿è¡Œ | 10-15åˆ†é’Ÿ | 5-10åˆ†é’Ÿ | æœ€ç®€å• |

*æ³¨ï¼šé¦–æ¬¡è¿è¡Œéœ€è¦æ„å»ºç´¢å¼•ï¼Œåç»­è¿è¡Œä¼šå¤ç”¨å·²æœ‰ç´¢å¼•*

---

## â“ å¸¸è§é—®é¢˜

### Q1: æç¤º "sudo: a terminal is required"

**åŸå› **: è„šæœ¬éœ€è¦ sudo æƒé™åˆ›å»ºå†…å­˜ç£ç›˜

**è§£å†³**: 
- åœ¨çœŸå®ç»ˆç«¯ä¸­æ‰‹åŠ¨è¿è¡Œè„šæœ¬ï¼Œæˆ–
- ä½¿ç”¨ä¸éœ€è¦ sudo çš„é€‰é¡¹2æˆ–é€‰é¡¹3

### Q2: "memory_workspace æ— æ³•åˆ é™¤"

**è§£å†³**:
```bash
sudo umount memory_workspace 2>/dev/null
rmdir memory_workspace
# æˆ–è¿è¡Œ
./cleanup_and_rerun.sh
```

### Q3: æƒ³æµ‹è¯•æ›´å¤šçº¿ç¨‹é…ç½®

ç¼–è¾‘ `benchmark-thread.cpp` ç¬¬520è¡Œï¼š

```cpp
// ä¿®æ”¹å‰
std::vector<int> thread_counts = {1,5,10,15,20};

// ä¿®æ”¹åï¼ˆä¾‹å¦‚ï¼‰
std::vector<int> thread_counts = {1,2,4,8,16,32,64};
```

ç„¶åé‡æ–°ç¼–è¯‘ï¼š
```bash
g++ -std=c++17 -O3 -o benchmark-thread benchmark-thread.cpp \
    -I ../.. -L ../../build/faiss \
    -Wl,-rpath,../../build/faiss -lfaiss -lopenblas -fopenmp
```

### Q4: ç´¢å¼•æ–‡ä»¶å·²å­˜åœ¨ï¼Œæƒ³é‡æ–°æ„å»º

```bash
rm ./sift/*.index
./run_disk_test_only.sh  # æˆ–å…¶ä»–æµ‹è¯•è„šæœ¬
```

---

## ğŸ“ ç›¸å…³æ–‡æ¡£

- ğŸ“– [`ä½¿ç”¨è¯´æ˜.md`](./ä½¿ç”¨è¯´æ˜.md) - å®Œæ•´ä½¿ç”¨æ‰‹å†Œ
- ğŸ” [`é—®é¢˜åˆ†ææŠ¥å‘Š.md`](./é—®é¢˜åˆ†ææŠ¥å‘Š.md) - é—®é¢˜è¯Šæ–­è¯¦æƒ…
- ğŸ› ï¸ `check_data_size.sh` - æ•°æ®æ£€æŸ¥å·¥å…·
- ğŸ§¹ `cleanup_and_rerun.sh` - æ¸…ç†å’Œé‡è¿è¡Œå·¥å…·

---

## âœ¨ ç°åœ¨å°±å¼€å§‹å§ï¼

æ‚¨çš„ç³»ç»Ÿèµ„æºå……è¶³ï¼ˆ212GBå¯ç”¨å†…å­˜ï¼‰ï¼Œæ‰€æœ‰é—®é¢˜å·²ä¿®å¤ï¼Œå¯ä»¥å®‰å…¨è¿è¡Œæµ‹è¯•äº†ï¼

**æ¨èå‘½ä»¤ï¼š**

```bash
cd /home/gpu/dry/faiss/tutorial/cpp

# å¦‚æœæœ‰sudoæƒé™ï¼Œè¿è¡Œå®Œæ•´å¯¹æ¯”æµ‹è¯•ï¼š
./simple_disk_memory_test.sh

# æˆ–è€…ï¼Œå¿«é€Ÿæµ‹è¯•ï¼ˆæ— éœ€sudoï¼‰ï¼š
./run_disk_test_only.sh
```

ç¥æµ‹è¯•é¡ºåˆ©ï¼ğŸ‰

